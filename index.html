<!DOCTYPE html>
<button onclick="openTab('papa')">Papà</button>
</nav>


<div id="marc" class="tab"></div>
<div id="aina" class="tab"></div>
<div id="mama" class="tab"></div>
<div id="papa" class="tab"></div>


<script>
const tabs = ['marc','aina','mama','papa'];


tabs.forEach(name => {
document.getElementById(name).innerHTML = generateTab(name);
});


function generateTab(user){
return `
<h2>${user.charAt(0).toUpperCase() + user.slice(1)}</h2>


<div class="btnType">
<button onclick="selectType('${user}','Necessitat')">Necessitat</button>
<button onclick="selectType('${user}','Caprici')">Caprici</button>
</div>


<textarea id="desc_${user}" placeholder="Descripció del regal"></textarea><br>
<input id="img_${user}" type="text" placeholder="URL de la imatge (opcional)"><br>
<input id="link_${user}" type="text" placeholder="Enllaç a la botiga (Amazon, Decathlon…)"><br>


<button id="addBtn" onclick="addGift('${user}')">Afegir a la llista</button>


<h3>Regals afegits:</h3>
<div id="list_${user}"></div>
`;
}


let selectedType = {};


function selectType(user, type){
selectedType[user] = type;
}


function addGift(user){
const desc = document.getElementById(`desc_${user}`).value;
const img = document.getElementById(`img_${user}`).value;
const link = document.getElementById(`link_${user}`).value;


if(!desc && !img && !link) return;


const gift = { type: selectedType[user] || '', desc, img, link };
const list = JSON.parse(localStorage.getItem(user) || '[]');
list.push(gift);
localStorage.setItem(user, JSON.stringify(list));


updateList(user);
}


function updateList(user){
const container = document.getElementById(`list_${user}`);
const list = JSON.parse(localStorage.getItem(user) || '[]');


container.innerHTML = list.map((g,i)=>`
<div class="giftItem">
<b>${g.type}</b><br>
${g.desc}<br>
${g.img ? `<img src="${g.img}" style="max-width:120px; margin:8px 0;">` : ''}
${g.link ? `<br><a href="${g.link}" target="_blank">Obrir enllaç</a>` : ''}<br>
<button class="deleteBtn" onclick="deleteGift('${user}',${i})">Esborrar</button>
</div>
`).join('');
}


function deleteGift(user, index){
const list = JSON.parse(localStorage.getItem(user) || '[]');
list.splice(index,1);
localStorage.setItem(user, JSON.stringify(list));
updateList(user);
}


function openTab(name){
document.querySelectorAll('.tab').forEach(t=>t.style.display='none');
document.getElementById(name).style.display='block';
updateList(name);
}


openTab('marc');
</script>
</body>
</html>
